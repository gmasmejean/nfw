

var adapter = function(application){
    this.app = application;
    if( !this.app._memorystore )
        this.app._memorystore = {};
};

adapter.prototype.ERROR_INVALID_KEY = {name:'SMA_1',code:98,message:'This session does not exist.'};

adapter.prototype.exist = function( key, next ){
    next( this.app._memorystore[key]?true:false );
};

adapter.prototype.create = function( key, data, next){
    this.app._memorystore[key] = data;
    next();
};

adapter.prototype.destroy = function( key, next ){
    delete(this.app._memorystore[key]);
    next(true);
};

adapter.prototype.setValue = function( key, vname, value, next ){
    if(this.app._memorystore[key]){
        this.app._memorystore[key][vname] = value;
        next(undefined,true);
    }
    else
        next(new error(error.bind.apply(error,this.ERROR_INVALID_KEY))());
};

adapter.prototype.getValue = function( key, vname, next ){
    if(this.app._memorystore[key])
        next(undefined,this.app._memorystore[key][vname]);
    else
        next(new error());
};

module.exports = adapter;